#!/usr/bin/env node

'use strict';

process.title = 'pollday';

var cli = require('commander');

cli
  .version('0.0.1')
  .option('-p, --port <value>', 'Listening port', 9091)
  .option('-f, --flashpolicyport <value>', 'Flash policy port', 10843)
  .option('-t, --timeout <value>', 'Reset timeout in seconds after the end of a poll')
  .parse(process.argv);

var Server = require('../lib/pollday-server.js');

var options = {
    'port':            parseInt(cli.port),
    'flashpolicyport': parseInt(cli.flashpolicyport),
    'timeout':         parseInt(cli.timeout)
};

var SocketFactory = require('../lib/socket-factory.js');

var server = new Server(new SocketFactory(), options);
